//---------------------------------------------------------------------------------------
// Copyright (c) 2001-2020 by PDFTron Systems Inc. All Rights Reserved.
// Consult legal.txt regarding legal and license information.
//---------------------------------------------------------------------------------------


const { PDFNet } = require('../../../lib/pdfnet.js');

((exports) => {
  'use strict';

  const convertOfficeToPDF = async(inputUrl, outputName) => {
    const doc = await PDFNet.Convert.officeToPdfWithPath(inputUrl);
    await doc.save('../../TestFiles/Output/' + outputName, PDFNet.SDFDoc.SaveOptions.e_linearized);
    console.log('Finished saving ' + outputName);
  };

  exports.runOfficeToPDF = () => {
    const inputDir = '../../TestFiles/';
    const docxFilename = 'simple-word_2007.docx';
    const pptxFilename = 'simple-powerpoint_2007.pptx';
    const xlsxFilename = 'simple-excel_2007.xlsx';

    const main = () => convertOfficeToPDF(inputDir + docxFilename, 'converted_docx.pdf')
      .then(() => convertOfficeToPDF(inputDir + pptxFilename, 'converted_pptx.pdf'))
      .then(() => convertOfficeToPDF(inputDir + xlsxFilename, 'converted_xlsx.pdf'))
      .then(() => console.log('Test Complete!'));
	  
    // add your own license key as the second parameter, e.g. PDFNet.runWithCleanup(main, 'YOUR_LICENSE_KEY')
    PDFNet.runWithCleanup(main).catch(function(error) {
      console.log('Error: ' + JSON.stringify(error));
    }).then(function(){ PDFNet.shutdown(); });
	
  };
  exports.runOfficeToPDF();
})(exports);
// eslint-disable-next-line spaced-comment
//# sourceURL=OfficeToPDFTest.js
